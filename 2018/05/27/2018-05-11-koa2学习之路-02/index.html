<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="记录技术学习以及读书心得"><meta name="keywords" content="study"><title>koa2学习之路-02-静态资源&amp;cookie&amp;jsonp&amp;测试 | 学习之路</title><link rel="stylesheet" type="text/css" href="//fonts.neworld.org/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.1"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.1"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">koa2学习之路-02-静态资源&amp;cookie&amp;jsonp&amp;测试</h1><a id="logo" href="/.">学习之路</a><p class="description">做只笨鸟</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="Arama"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">koa2学习之路-02-静态资源&amp;cookie&amp;jsonp&amp;测试</h1><div class="post-meta"><a href="/2018/05/27/2018-05-11-koa2学习之路-02/#comments" class="comment-count"></a><p><span class="date">May 27, 2018</span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>点击</i></i></span></p></div><div class="post-content"><h1 id="koa2学习之路-02-静态资源-cookie-jsonp-测试"><a href="#koa2学习之路-02-静态资源-cookie-jsonp-测试" class="headerlink" title="koa2学习之路-02-静态资源-cookie-jsonp-测试"></a>koa2学习之路-02-静态资源-cookie-jsonp-测试</h1><p>koa2针对静态资源提供了一个<code>koa-static</code>package。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">var Koa = require(&apos;koa&apos;)</span><br><span class="line">var KoaStatic = require(&apos;koa-static&apos;)</span><br><span class="line">var path = require(&apos;path&apos;)</span><br><span class="line"></span><br><span class="line">// 静态资源目录对于相对入口文件index.js的路径</span><br><span class="line">const staticPath = &apos;./static&apos;</span><br><span class="line">var app = new Koa()</span><br><span class="line">app.use(KoaStatic(</span><br><span class="line">    path.join(__dirname, staticPath)</span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">app.listen(3000, () =&gt; &#123;</span><br><span class="line">    console.log(path.join(__dirname, staticPath))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<h2 id="koa2实现cookie"><a href="#koa2实现cookie" class="headerlink" title="koa2实现cookie"></a>koa2实现cookie</h2><p>直接用上下文cookie对象操作cookie。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">var Koa = require(&apos;koa&apos;)</span><br><span class="line">var app = new Koa()</span><br><span class="line">app.use(async(ctx) =&gt; &#123;</span><br><span class="line">    if (ctx.url === &apos;/&apos;) &#123;</span><br><span class="line">        ctx.cookies.set(&apos;cid&apos;,</span><br><span class="line">            &apos;hello world&apos;, &#123;</span><br><span class="line">                domain: &apos;localhost&apos;, // 写cookie所在的域名</span><br><span class="line">                path: &apos;/index&apos;, // 写cookie所在的路径</span><br><span class="line">                maxAge: 10 * 60 * 1000, // cookie有效时长</span><br><span class="line">                expires: new Date(&apos;2019-02-15&apos;), // cookie失效时间</span><br><span class="line">                httpOnly: false, // 是否只用于http请求中获取</span><br><span class="line">                overwrite: false // 是否允许重写</span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">        ctx.body = &apos;cookie set ok&apos;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        ctx.body = &apos;hello world&apos;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.listen(3000, () =&gt; &#123;</span><br><span class="line">    console.log(&apos;server is running on port 3000&apos;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>注意上述代码中，<code>cookies.set(name,value,option)</code>的函数参数，第一个是key，第二个是vlaue，第三个是option。   </p>
<h2 id="session"><a href="#session" class="headerlink" title="session"></a>session</h2><p>koa2原生功能只提供了cookie的操作，但是没有提供session操作。session就只用自己实现或者通过第三方中间件实现。在koa2中实现session的方案有一下几种</p>
<ul>
<li>如果session数据量很小，可以直接存在内存中</li>
<li>如果session数据量很大，则需要存储介质存放session数据   </li>
</ul>
<h2 id="模板引擎"><a href="#模板引擎" class="headerlink" title="模板引擎"></a>模板引擎</h2><p>koa使用<code>koa-views</code>在服务器端渲染视图，另外采用<code>ejs</code>模板。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">const Koa = require(&apos;koa&apos;)</span><br><span class="line">const views = require(&apos;koa-views&apos;)</span><br><span class="line">const path = require(&apos;path&apos;)</span><br><span class="line">const app = new Koa()</span><br><span class="line"></span><br><span class="line">// 加载模板引擎</span><br><span class="line">app.use(views(path.join(__dirname, &apos;./view&apos;), &#123;</span><br><span class="line">    extension: &apos;ejs&apos;</span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line">app.use(async(ctx) =&gt; &#123;</span><br><span class="line">    let title = &apos;hello koa2&apos;</span><br><span class="line">    await ctx.render(&apos;index&apos;, &#123;</span><br><span class="line">        title,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.listen(3000)</span><br></pre></td></tr></table></figure>
<p>index.ejs模板内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;&lt;%= title %&gt;&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt;&lt;%= title %&gt;&lt;/h1&gt;</span><br><span class="line">    &lt;p&gt;EJS Welcome to &lt;%= title %&gt;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="jsonp实现"><a href="#jsonp实现" class="headerlink" title="jsonp实现"></a>jsonp实现</h2><p>在项目复杂的业务场景，有时候需要在前端跨域获取数据，这时候提供数据的服务就需要提供跨域请求的接口，通常是使用JSONP的方式提供跨域接口。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">var Koa = require(&apos;koa&apos;)</span><br><span class="line">var app = new Koa()</span><br><span class="line">app.use(async(ctx) =&gt; &#123;</span><br><span class="line">    // 判断是否为JSONP的请求 </span><br><span class="line">    if (ctx.method === &apos;GET&apos; &amp;&amp; ctx.url.split(&apos;?&apos;)[0] === &apos;/getData.jsonp&apos;) &#123;</span><br><span class="line">        // 获取jsonp的callback</span><br><span class="line">        let callbackName = ctx.query.callback || &apos;callback&apos;</span><br><span class="line">        let returnData = &#123;</span><br><span class="line">            success: true,</span><br><span class="line">            data: &#123;</span><br><span class="line">                text: &apos;this is a jsonp api&apos;,</span><br><span class="line">                time: new Date().getTime(),</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        // jsonp的script字符串</span><br><span class="line">        let jsonpStr = `;$&#123;callbackName&#125;($&#123;JSON.stringify(returnData)&#125;)`</span><br><span class="line"></span><br><span class="line">        // 用text/javascript，让请求支持跨域获取</span><br><span class="line">        ctx.type = &apos;text/javascript&apos;</span><br><span class="line"></span><br><span class="line">        // 输出jsonp字符串</span><br><span class="line">        ctx.body = jsonpStr</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">app.listen(3000, () =&gt; &#123;</span><br><span class="line">    console.log(&apos;server is running on port 3000&apos;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>下面使用<code>koa-jsonp</code>中间件实现一版。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">const Koa = require(&apos;koa&apos;)</span><br><span class="line">const jsonp = require(&apos;koa-jsonp&apos;)</span><br><span class="line">const app = new Koa()</span><br><span class="line"></span><br><span class="line">// 使用中间件</span><br><span class="line">app.use(jsonp())</span><br><span class="line"></span><br><span class="line">app.use(async(ctx) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">    let returnData = &#123;</span><br><span class="line">        success: true,</span><br><span class="line">        data: &#123;</span><br><span class="line">            text: &apos;this is a jsonp api&apos;,</span><br><span class="line">            time: new Date().getTime(),</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 直接输出JSON</span><br><span class="line">    ctx.body = returnData</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.listen(3000, () =&gt; &#123;</span><br><span class="line">    console.log(&apos;[demo] jsonp is starting at port 3000&apos;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p><code>jsonp</code>解析原理：</p>
<ol>
<li>JSONP跨域输出的数据是可执行的JavaScript代码</li>
</ol>
<ul>
<li>ctx输出的类型应该是’text/javascript’</li>
<li>ctx输出的内容为可执行的返回数据JavaScript代码字符串</li>
</ul>
<ol start="2">
<li>需要有回调函数名callbackName，前端获取后会通过动态执行JavaScript代码字符，获取里面的数据</li>
</ol>
<h2 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h2><p>测试是一个项目周期里必不可少的环节，开发者在开发过程中也是无时无刻进行“人工测试”，如果每次修改一点代码，都要牵一发动全身都要手动测试关联接口，这样子是禁锢了生产力。为了解放大部分测试生产力，相关的测试框架应运而生，比较出名的有mocha，karma，jasmine等。虽然框架繁多，但是使用起来都是大同小异。  </p>
<h3 id="安装单元测试库"><a href="#安装单元测试库" class="headerlink" title="安装单元测试库"></a>安装单元测试库</h3><p><code>npm install --save-dev mocha chai supertest</code>   </p>
<ul>
<li>mocha 模块是测试框架</li>
<li>chai 模块是用来进行测试结果断言库，比如一个判断 1 + 1 是否等于 2</li>
<li>supertest 模块是http请求测试库，用来请求API接口   <h3 id="创建demo程序"><a href="#创建demo程序" class="headerlink" title="创建demo程序"></a>创建demo程序</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">const Koa = require(&apos;koa&apos;)</span><br><span class="line">const app = new Koa()</span><br><span class="line"></span><br><span class="line">const server = async(ctx, next) =&gt; &#123;</span><br><span class="line">    let result = &#123;</span><br><span class="line">        success: true,</span><br><span class="line">        data: null</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (ctx.method === &apos;GET&apos;) &#123;</span><br><span class="line">        if (ctx.url === &apos;/getString.json&apos;) &#123;</span><br><span class="line">            result.data = &apos;this is string data&apos;</span><br><span class="line">        &#125; else if (ctx.url === &apos;/getNumber.json&apos;) &#123;</span><br><span class="line">            result.data = 123456</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            result.success = false</span><br><span class="line">        &#125;</span><br><span class="line">        ctx.body = result</span><br><span class="line">        next &amp;&amp; next()</span><br><span class="line">    &#125; else if (ctx.method === &apos;POST&apos;) &#123;</span><br><span class="line">        if (ctx.url === &apos;/postData.json&apos;) &#123;</span><br><span class="line">            result.data = &apos;ok&apos;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            result.success = false</span><br><span class="line">        &#125;</span><br><span class="line">        ctx.body = result</span><br><span class="line">        next &amp;&amp; next()</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        ctx.body = &apos;hello world&apos;</span><br><span class="line">        next &amp;&amp; next()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.use(server)</span><br><span class="line"></span><br><span class="line">module.exports = app</span><br><span class="line"></span><br><span class="line">app.listen(3000, () =&gt; &#123;</span><br><span class="line">    console.log(&apos;[demo] test-unit is starting at port 3000&apos;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>注意上述代码中有一句<code>app.use(server)</code>这是为了供测试框架调用，访问<code>http://127.0.0.1:3000/getString.json</code>，输出结果为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">success: true,</span><br><span class="line">data: &quot;this is string data&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="测试框架代码"><a href="#测试框架代码" class="headerlink" title="测试框架代码"></a>测试框架代码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">const supertest = require(&apos;supertest&apos;)</span><br><span class="line">const chai = require(&apos;chai&apos;)</span><br><span class="line">const app = require(&apos;../index&apos;)</span><br><span class="line"></span><br><span class="line">const expect = chai.expect</span><br><span class="line">const request = supertest(app.listen())</span><br><span class="line"></span><br><span class="line">//测试组套件</span><br><span class="line">describe(&apos;开始测试demo的getString请求&apos;,</span><br><span class="line">    //测试用例</span><br><span class="line">    it(&apos;测试/getString.json请求&apos;, (done) =&gt; &#123;</span><br><span class="line">        request.get(&apos;/getString.json&apos;).expect(200).end((err, res) =&gt; &#123;</span><br><span class="line">            expect(res.body).to.be.an(&apos;object&apos;)</span><br><span class="line">            expect(res.body.success).to.be.an(&apos;boolean&apos;)</span><br><span class="line">            expect(res.body.data).to.be.an(&apos;string&apos;)</span><br><span class="line">            done()</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;))</span><br></pre></td></tr></table></figure>
<p>全部安装<code>mocha</code>后，直接在上述代码文件目录内执行<code>mocha --harmony</code>，执行结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[demo] test-unit is starting at port 3000</span><br><span class="line">  √ 测试/getString.json请求</span><br><span class="line"></span><br><span class="line">  1 passing (46ms)</span><br></pre></td></tr></table></figure></p>
<h2 id="更新package-json中的包"><a href="#更新package-json中的包" class="headerlink" title="更新package.json中的包"></a>更新package.json中的包</h2><ul>
<li>安装：<br><code>npm install -g npm-check-updates</code></li>
<li><p>检查package.json中dependencies的最新版本：<br><code>ncu</code></p>
</li>
<li><p>更新dependencies到新版本：<br><code>ncu -u</code></p>
</li>
</ul>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p>感谢让我站在肩膀上的大神<code>chenshenhai</code>。<br><a href="https://chenshenhai.github.io/koa2-note/note/static/server.html" target="_blank" rel="noopener">koa2实践</a><br><a href="https://tonghuashuo.github.io/blog/jsonp.html" target="_blank" rel="noopener">5分钟讲透jsonp</a></p>
</div><div class="tags"><a href="/tags/nodejs/">nodejs</a></div><div class="post-share"><div class="bdsharebuttonbox"><span style="float:left;line-height: 28px;height: 28px;font-size:16px;font-weight:blod">分享到：</span><a href="#" data-cmd="more" class="bds_more"></a><a href="#" data-cmd="mshare" title="分享到一键分享" class="bds_mshare"></a><a href="#" data-cmd="fbook" title="分享到Facebook" class="bds_fbook"></a><a href="#" data-cmd="twi" title="分享到Twitter" class="bds_twi"></a><a href="#" data-cmd="linkedin" title="分享到linkedin" class="bds_linkedin"></a><a href="#" data-cmd="youdao" title="分享到有道云笔记" class="bds_youdao"></a><a href="#" data-cmd="evernotecn" title="分享到印象笔记" class="bds_evernotecn"></a><a href="#" data-cmd="weixin" title="分享到微信" class="bds_weixin"></a><a href="#" data-cmd="qzone" title="分享到QQ空间" class="bds_qzone"></a><a href="#" data-cmd="tsina" title="分享到新浪微博" class="bds_tsina"></a></div></div><div class="post-nav"><a href="/2018/05/27/2018-05-15-github_travis_coveralls自动集成自动部署/" class="pre">github_travis_coveralls自动集成自动部署</a><a href="/2018/05/27/2018-05-11-koa2学习之路-01/" class="next">koa2学习之路-01</a></div><div id="comments"><div id="lv-container" data-id="city" data-uid="MTAyMC8zNTcyNC8xMjI2MA"></div></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#koa2学习之路-02-静态资源-cookie-jsonp-测试"><span class="toc-text">koa2学习之路-02-静态资源-cookie-jsonp-测试</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#koa2实现cookie"><span class="toc-text">koa2实现cookie</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#session"><span class="toc-text">session</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#模板引擎"><span class="toc-text">模板引擎</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jsonp实现"><span class="toc-text">jsonp实现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#单元测试"><span class="toc-text">单元测试</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#安装单元测试库"><span class="toc-text">安装单元测试库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#创建demo程序"><span class="toc-text">创建demo程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试框架代码"><span class="toc-text">测试框架代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#更新package-json中的包"><span class="toc-text">更新package.json中的包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考"><span class="toc-text">参考</span></a></li></ol></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/08/23/2018-08-23-微服务设计笔记10/">微服务设计笔记10</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/23/2018-08-22-微服务设计笔记09/">微服务设计笔记09</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/20/2018-08-20-微服务设计笔记08/">微服务设计笔记08</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/20/2018-08-19-微服务实践04-熔断监控Hystrix Dashboard和Turbine/">微服务实践04-熔断监控Hystrix Dashboard和Turbine</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/20/2018-08-18-微服务实践03-熔断器Hystrix/">微服务实践03-熔断器histrix</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/20/2018-08-18-微服务实践02-eureka服务提供者和消费者/">微服务实践02-eureka服务提供者和消费者</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/20/2018-08-18-微服务实践01-服务中心eureka/">微服务实践01-服务中心eureka</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/17/2018-08-17-微服务设计笔记07/">微服务设计笔记07</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/14/2018-08-14-微服务设计笔记06/">微服务设计笔记06</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/13/2018-08-13-穷查理宝典语句摘抄/">穷查理宝典语句摘抄</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/运动/" style="font-size: 15px;">运动</a> <a href="/tags/读书/" style="font-size: 15px;">读书</a> <a href="/tags/ES6/" style="font-size: 15px;">ES6</a> <a href="/tags/规划/" style="font-size: 15px;">规划</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/CICD/" style="font-size: 15px;">CICD</a> <a href="/tags/docker/" style="font-size: 15px;">docker</a> <a href="/tags/nodejs/" style="font-size: 15px;">nodejs</a> <a href="/tags/微服务/" style="font-size: 15px;">微服务</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> 友情链接</i></div><ul></ul><a href="https://github.com/dumingcode" title="github" target="_blank">github</a></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">Baidu Site Haritası</a> |  <a href="/atom.xml">订阅</a> |  <a href="/about/">关于</a></p><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次</p><p><span> Copyright &copy;<a href="/." rel="nofollow">DuMing.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.json.js?v=2.0.1"></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.1" async></script><script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","weixin","tsina","qzone","linkedin","fbook","twi","print","renren","sqq","evernotecn","bdysc","tqq","tqf","bdxc","kaixin001","tieba","douban","bdhome","thx","ibaidu","meilishuo","mogujie","diandian","huaban","duitang","hx","fx","youdao","sdo","qingbiji","people","xinhua","mail","isohu","yaolan","wealink","ty","iguba","h163","copy"],"bdPic":"","bdStyle":"1","bdSize":"16"},"share":{},"image":{"viewList":["tsina","qzone","weixin","fbook","twi","linkedin","youdao","evernotecn","mshare"],"viewText":"分享到：","viewSize":"16"},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["tsina","qzone","weixin","fbook","twi","linkedin","youdao","evernotecn","mshare"]}};with(document)0[(getElementsByTagName('head')[0]||head).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script><script>(function(d, s) {
  var j, e = d.getElementsByTagName('body')[0];
  if (typeof LivereTower === 'function') { return; }
  j = d.createElement(s);
  j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
  j.async = true;
  e.appendChild(j);
})(document, 'script');
</script></body></html>